SELECT 
D.DEPARTMENT,
AVG(DATEDIFF (MONTH,INDATE,ISNULL(OUTDATE,GETDATE())) ) AS AY
FROM DEPARTMENT D
INNER JOIN PERSON P ON P.DEPARTMENTID=D.ID
GROUP BY D.DEPARTMENT
ORDER BY 2
